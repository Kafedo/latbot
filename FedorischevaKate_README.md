# Телеграмм-бот *Latin Status*
***Ссылка на pythonanywhereapp:*** http://kafedor.pythonanywhere.com/

***Логин бота:*** @latin_status_bot

Я решила сделать телеграмм-бота, в котором можно смотреть крылатые (и не очень) выражения на латыни с морфологическим разбором и схемой грамматических зависимостей
## Подготовка "начинки":
* Краулер и первичная обработка скачанного:
    
    *(requests, fake_useragent, bs4, re, pandas)* 
    Со страницы [Википедии с латинскими выражениями](https://ru.wikipedia.org/wiki/Список_крылатых_латинских_выражений) скриптом из файла crawler.py был получен датафрейм со столбцами "фраза" — "значение", сохранённая во phrases.csv
* Создание основного датасета и схем cкриптом parcer.py:
    * *(SpaCy)* Создание колонки с лемматизированными фразами и их зачениями (для функции поиска)
    * *(SpaCy)* Создание колонки с готовыми к отправке разборами 
    * *(SpaCy, displayCy)* Создание cхем зависимостей 
    * *(svglib.svglib, reportlab.graphics)* Схемы сохраняются только в формате svg, тг-бот не обрабаотывает этот формат, поэтому переводим их в png и сохраняем в папке plots с индексом фразы в названии
## Начинка:
### Рандомная фраза:
1) бот выдаёт случайную фразу из базы с разбором и схемой
2) фразу можно сохранить в коллекцию (кнопкой)
3) можно продолжать вызывать рандомные фразы или вернуться в меню (по кнопке)
### Поиск фразы по ключевым словам:
1) бот принимает сообщение пользователя, лемматизирует его и выдаёт список фраз, которые их включают.  Работает только для поиска по-русски, потому что для бесплатного pythonanywhere латинская модель слишком тяжёлая.
2) пользователь вводит номер фразы, разбор которой хочет посмотреть, и тогда получает разбор и схему, или вводит любую строку, и тогда возвращается в меню
3) фразу можно сохранить в коллекцию
4) если не найдено ни одной подходящей фразы, пользователю предлагают поискать что-нибудь другое
### Сохранение в коллекцию:
если пользователь нажимает кнопку "сохранить в коллекцию" под фразой, то:
1) выезжает меню с вопросом, в какой раздел коллекции он хочет добавить фразу
2) когда пользователь выбирает нужный раздел, в словарь в файле archieve/col.json где ключи — id пользователей, значения — словари "раздел: список индексов сохранённых фраз" в нужный список добавляется индекс нужной фразы
3) после сохранения пользователь возвращается в меню
### Коллекция:
1) если коллекция пуста, пользователю об этом сообщают и возвращают его в главное меню
2) если в коллекции есть хоть что-то, то пользователь получает диаграммку с распределением его сохранённых фраз по разделам и меню, в котором он может выбрать, какой (не пустой) раздел посмотреть (или сразу все).
3) после выбора кнопки, высылается полный список содержимого одного или всех разделов, и пользователь может отправить число, чтобы посмотреть разбор, или отправить символ "k", чтобы вернуться в коллекцию, или что угодно другое, чтобы вернуться в главное меню
4) когда человек просматривает сохранённый разбор, он может кнопкой удалить его из раздела. По другим кнопкам он может вернуться в раздел, в коллекцию или в главное меню. (Если пользователь случайно ввёл номер фразы, которой на самом деле нет в его коллекции, то кнопка "удалить" и "вернуться в раздел" - не отображаются)

## По критериям:
* 2 балла: бот работает, имеет понятный для пользователя интерфейс: описание (в том числе, в README в папке с проектом), команды, помощь и т.п.
    * Чек! Все мои друзья пытались сломать этот бот, он через многое прошёл, он справился!
* 3 балла: используется морфологический или синтаксический парсинг, модель 
    * Чек! Причём не только для лемматизации и морф.разборов, но и для построения схем зависимостей!
* 1 балл: есть интересный функционал: аудио, картинки, кнопки:
    * Чек! Сплошные кнопки, клавиатуры, картинки, иногда стикеры и всё, что неинтуитивно, эксплицитно прописано!
* 2 балла: код проекта выложен в репозиторий, а также на pythonanywhere. Т.е. телеграм-бот должен работать вне зависимости от того, запущен ли код на вашем/чьем-то другом компьютере.
    * Чек! Всё по красоте!

    Ссылка на ваше pythonanywhereapp должна быть в README в папке с проектом 
    * *(см. в самом начале этого файла)*
    
* 2 балла: что-то оригинальное: элементы машинного обучения, сложные графики, статистика и т.п. 
    * Перерыто очень много библиотек и моделей, чтобы всё работало и интерфейс был приятный, ничего не падало и юзер мог удобно перемещаться по всему боту. И вообще посмотрите, какой аккуратный интерфейс и стикеры с котиками. Я считаю, что это достойно!
